 <!-- FlatFy Theme - Andrea Galanti /-->
<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="Flatfy Free Flat and Responsive HTML5 Template ">
    <meta name="author" content="">

    <title>AlphaTrip</title>

    <!-- Bootstrap core CSS -->
    <link href="static/css/bootstrap.min.css" rel="stylesheet">
 
    <!-- Custom Google Web Font -->
    <link href="static/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Arvo:400,700' rel='stylesheet' type='text/css'>
    
    <!-- Custom CSS-->
    <link href="static/css/general.css" rel="stylesheet">
    <link rel="shortcut icon" href="static/img/favicon.ico" />
    
     <!-- Owl-Carousel -->
    <link href="static/css/custom.css" rel="stylesheet">
    <link href="static/css/owl.carousel.css" rel="stylesheet">
    <link href="static/css/owl.theme.css" rel="stylesheet">
    <link href="static/css/style.css" rel="stylesheet">
    <link href="static/css/animate.css" rel="stylesheet">
    
    <!-- Magnific Popup core CSS file -->
    <link rel="stylesheet" href="static/css/magnific-popup.css"> 
    
    <script src="static/js/modernizr-2.8.3.min.js"></script> 

    <script type="text/javascript" src="static/js/index.js"></script>
    
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

     <!-- Modernizr /-->
    <!--[if IE 9]>
        <script src="js/PIE_IE9.js"></script>
    <![endif]-->
    <!--[if lt IE 9]>
        <script src="js/PIE_IE678.js"></script>
    <![endif]-->

    <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
    <![endif]-->
    <style type="text/css">
    	tab1 { padding-left: 4em; }
        .table{
            border:5px #D9DED1 double;
            padding:5px;
        }
        .table td.red{
            color:red;
        }
        .table td.setcolor{
            color:#4169E1;
        }
        table{
            margin-left:auto; 
            margin-right:auto;
        }
        td{
            text-align:center;
            font-weight:bolder;
            font-size: 19px;
        }
        #picture{
            text-align:center;
        }
        #button{
            text-align:center;
        }
        p{
            font-size: 23px;
            font-weight:bolder;
        }
        span.tab{
            padding: 25px;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #map {
            height: 100%;
        }
        #warnings-panel {
            width: 100%;
            height:10%;
            text-align: center;
        }
        #floating-panel {
            position: absolute;
            //top: 10px;
            left: 60%;
            z-index: 5;
            background-color: #fff;
            padding: 5px;
            border: 1px solid #999;
            text-align: center;
            font-family: 'Roboto','sans-serif';
            line-height: 30px;
            padding-left: 10px;
        }

        input[type="range"]{
          -webkit-appearance: none;
          border-radius:2px;
          width:200px;
          height:3px;
          background-image:-webkit-linear-gradient(left ,#f22 0%,#f22 50%,#fff 50%, #fff 100%);
          box-shadow:inset #ebb 0 0 5px;
          outline : none;
          transition:.1s;
        }
        input[type="range"]::-webkit-slider-thumb{
          -webkit-appearance: none;
          width:10px;
          height:10px;
          background:#f22;
          border-radius:50%;
          transition:.1s;
        }
        input[type="range"]::-webkit-slider-thumb:hover,
        input[type="range"]::-webkit-slider-thumb:active{
          width:16px;
          height:16px;
        }
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
    <script src="http://code.jquery.com/jquery-1.9.1.js" ></script>
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js" ></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/css/bootstrap-select.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"></script>
    <script>
        $(document).ready(function () {
            // initialize the viewer
            $('#submit').click(function (event) {
                sendForm()
                var dataToSend = JSON.stringify(params);
                $.ajax(
                        {
                            url: '/schedule',
                            type: 'POST',
                            data: dataToSend,
                            success: function (jsonResponse) {
                                ans = JSON.parse(jsonResponse);
                                initTravelTime(document.getElementById("travelTime"));
                                wayptsChange(1);
                                $("table").children().remove()
                                buildTable();
                            },
                            error: function () {
                                $("#responsefield").text("Error to load api");
                            }
                        });
                event.preventDefault();
            });
        });
    </script>

</head>

<body id="home">
    <!-- Facebook -->
    <script>
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '658154467650069',
          xfbml      : true,
          version    : 'v2.5'
        });

        FB.getLoginStatus(function(response) {
          if (response.status === 'connected') {
            console.log('Logged in.');
          }
          else {
            FB.login();
          }
        });
      };

      (function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         js.src = "//connect.facebook.net/en_US/sdk.js";
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));
    </script>

    <!-- Preloader -->
    <div id="preloader">
        <div id="status"></div>
    </div>
    
    <!-- FullScreen -->
    <div class="intro-header">
        <div class="col-xs-12 text-center abcen1">
            <h1 class="h1_home wow fadeIn" data-wow-delay="0.4s">AlphaTrip</h1>
            <h3 class="h3_home wow fadeIn" data-wow-delay="0.6s">旅行，說走就走</h3>
            <ul class="list-inline intro-social-buttons">

            </ul>
        </div>    
        <!-- /.container -->
        <div class="col-xs-12 text-center abcen wow fadeIn">
            <div class="button_down "> 
                <a class="imgcircle wow bounceInUp" data-wow-duration="1.5s"  href="#whatis"> <img class="img_scroll" src="static/img/icon/circle.png" alt=""> </a>
            </div>
        </div>
    </div>
    
    <!-- NavBar-->
    <nav class="navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#home">AlphaTrip</a>
            </div>

            <div class="collapse navbar-collapse navbar-right navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                    <li class="menuItem"><a href="#whatis">特色介紹</a></li>
                    <li class="menuItem"><a href="#useit">開始使用</a></li>
                    <!--<li class="menuItem"><a href="#screen">Screenshot</a></li>
                    <li class="menuItem"><a href="#credits">Credits</a></li>-->
                    <li class="menuItem"><a href="#contact">聯絡我們</a></li>
                </ul>
            </div>
           
        </div>
    </nav>
    
    <!-- What is -->
    <div id="whatis" class="content-section-b" style="border-top: 0">
        <div class="container">
            
            <div class="row">
            
                <div class="col-sm-4 wow fadeInDown text-center">
                  <img class="rotate" src="static/img/icon/tweet.svg" alt="Generic placeholder image">
                  <h3>個人化</h3>
                  <p class="lead">根據不同興趣，推薦行程</p>

                  <!-- <p><a class="btn btn-embossed btn-primary view" role="button">View Details</a></p> -->
                </div><!-- /.col-lg-4 -->
                
                <div class="col-sm-4 wow fadeInDown text-center">
                  <img  class="rotate" src="static/img/icon/picture.svg" alt="Generic placeholder image">
                   <h3>旅遊資訊</h3>
                   <p class="lead">不再需要花大把時間做功課</p>
                   <!-- <p><a class="btn btn-embossed btn-primary view" role="button">View Details</a></p> -->
                </div><!-- /.col-lg-4 -->
                
                <div class="col-sm-4 wow fadeInDown text-center">
                  <img  class="rotate" src="static/img/icon/retina.svg" alt="Generic placeholder image">
                   <h3>地圖導航</h3>
                    <p class="lead">就算在人生地不熟的國外，也可以自在地遊玩</p>
                  <!-- <p><a class="btn btn-embossed btn-primary view" role="button">View Details</a></p> -->
                </div><!-- /.col-lg-4 -->
                
            </div><!-- /.row -->
                
        </div>
    </div>
    
    <!-- Use it -->
    <div id ="useit" class="content-section-a">

        <div class="container">
            
            <div class="row">
            
                <div class="col-sm-6 pull-right wow fadeInRightBig">
                    <img class="img-responsive " src="static/img/ipad.png" alt="">
                </div>
                
                <div class="col-sm-6 wow fadeInLeftBig"  data-animation-delay="200">   
                    <h3 class="section-heading">一次規劃好整趟行程</h3>
                    <p class="lead">
                        從你下飛機後，都不再需要煩惱
                    </p>

                     <p><a class="btn btn-embossed btn-primary" href="#" role="button">View Details</a> 
                     <a class="btn btn-embossed btn-info" href="#" role="button">Visit Website</a></p>
                </div>   
            </div>
        </div>
        <!-- /.container -->
    </div>
    
    <!-- Banner Download -->
    <div id="downloadlink" class="banner">
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 text-center wrap_title">
                <h2>出發去旅行吧</h2>
                <p><a href="#contact" class="btn btn-embossed btn-primary view" role="button">Go</a></p> 
             </div>
            </div>
        </div>
    </div>
    
    <!-- Contact -->
    <div id="contact" class="content-section-a">
        <div class="container">
            <div class="row">
            
            <div class="col-md-6 col-md-offset-3 text-center wrap_title">
                <h2>Japan Travel</h2>
                <p class="lead" style="margin-top:0"></p>
            </div>
            
            <form role="form" id="travelForm">
                <div class="col-md-6">
                    <b>startDate: </b>
                    <input type="text" id="startDate" class="input">
                    <b>endDate: </b>
                    <input type="text" id="endDate" class="input"><br>

                    <b>Start Airport: </b>
                    <select id="startAirport"></select>
                    <b>Start Time: </b>
                    <select id="startTime"></select><br>

                    <b>Final Airport: </b>
                    <select id="endAirport"></select>
                    <b>Final Time: </b>
                    <select id="endTime"></select><br>
                    
                    <b>Budget: </b>
                    <select id="Budget" class="form-control form-control-sm" style="height:30%;">
                        <option value="1">低</option>
                        <option value="2">中</option>
                        <option value="3">高</option>
                    </select>
                    請勾選你的興趣<br>
                    <div id="checkboxList"></div>
                    <!--<input type="button" value="submit" id="submit" onclick="sendForm();"class="btn wow tada btn-embossed btn-primary pull-left">-->
                    <input type="submit" name="submit" id="submit" class="btn wow tada btn-embossed btn-primary pull-right">
                </div>
            </form>

            <!--<form role="form" action="" method="post" >
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="InputName">Your Name</label>
                        <div class="input-group">
                            <input type="text" class="form-control" name="InputName" id="InputName" placeholder="Enter Name" required>
                            <span class="input-group-addon"><i class="glyphicon glyphicon-ok form-control-feedback"></i></span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="InputEmail">Your Email</label>
                        <div class="input-group">
                            <input type="email" class="form-control" id="InputEmail" name="InputEmail" placeholder="Enter Email" required  >
                            <span class="input-group-addon"><i class="glyphicon glyphicon-ok form-control-feedback"></i></span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="InputMessage">Message</label>
                        <div class="input-group">
                            <textarea name="InputMessage" id="InputMessage" class="form-control" rows="5" required></textarea>
                            <span class="input-group-addon"><i class="glyphicon glyphicon-ok form-control-feedback"></i></span>
                        </div>
                    </div>

                    <input type="submit" name="submit" id="submit" value="Submit" class="btn wow tada btn-embossed btn-primary pull-right">
                </div>
            </form>-->
            
            <hr class="featurette-divider hidden-lg">
                <div class="col-md-5 col-md-push-1 address">
                    <address>
                    <h3>BL Lab618</h3>
                    <p class="lead">
                    <a href="https://www.google.com.tw/maps/place/%E8%87%BA%E7%81%A3%E5%A4%A7%E5%AD%B8/" target='_blank'>NTU<br>
                    10617台北市 大安區羅斯福路四段1號</a><br>
                    Name: Kobe不要退休<br>
                    Phone: XXX-XXX-XXXX<br>
                    Fax: XXX-XXX-YYYY</p>
                    </address>

                    <h3>Social</h3>
                    <li class="social"> 
                    <a href="#"><i class="fa fa-facebook-square fa-size"> </i></a>
                    <a href="#"><i class="fa  fa-twitter-square fa-size"> </i> </a> 
                    <a href="#"><i class="fa fa-google-plus-square fa-size"> </i></a>
                    <a href="#"><i class="fa fa-flickr fa-size"> </i> </a>
                    </li>
                </div>
            </div>
        </div>
    </div>

    <b>時間: </b>
    <select id="travelTime" onchange="travelTimeChange()"></select><br>

    <div id="map" style="float:right;width:60%; height:75%"></div>
    <div style="float:left;width:40%;">
        <table id="table" class='table' border='5' bgcolor='#88EEEE'>
        <!--<TH>place</TH><TH>popularity</TH><TH>topic</TH><TH>priceLevel</TH>-->
        </table>
    </div>

    <div id="floating-panel" style="float:right;width:30%;">
	        <b>Start: </b>
	        <select id="start">
	            <option value="日本〒100-0005 Tokyo, Chiyoda, Marunouchi, 1 丁目 呑んき１丸の内北口店 9">東京車站</option>
	                <!--<option value="1-1 Maihama, Urayasu, Chiba Prefecture 279-0031日本">東京迪士尼</option>-->
	        </select>
	        <b>End: </b>
	        <select id="end">
	        <!--<option value="35.829905, 140.390619">成田機場</option>-->
	        <option value="日本〒100-0005 Tokyo, Chiyoda, Marunouchi, 1 丁目 呑んき１丸の内北口店 9">東京車站</option>
	        </select>
	</div>
	<div id="warnings-panel" style="float:right;width:85%;height:15%"></div>    
    &nbsp;
    <div id="directionsPanel" style="float:right;width:15%;height:85%"></div>
    
    <!-- Footer -->
    <footer class="text-center">
        <div class="footer-above">
            <div class="container">
                <div class="row">
                    <div class="footer-col col-lg-12 col-md-12  col-sm-12 col-xs-12">
                        <h3>GitHub</h3>
                        <ul class="list-inline">
                            <li>
                                <a href="https://github.com/behappycc/bdhackathon" class="btn-social btn-outline"><i class="fa fa-4x fa-github"></i></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 col-md-12  col-sm-12 col-xs-12">
                        <p>© 2016 Kobe不要退休 </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <!--<script src="static/js/jquery-1.10.2.js"></script>-->
    <script src="static/js/bootstrap.js"></script>
    <script src="static/js/owl.carousel.js"></script>
    <script src="static/js/script.js"></script>
    <!-- StikyMenu -->
    <script src="static/js/stickUp.min.js"></script>
    <script type="text/javascript">
      jQuery(function($) {
        $(document).ready( function() {
          $('.navbar-default').stickUp();
          
        });
      });
    
    </script>
    <!-- Smoothscroll -->
    <script type="text/javascript" src="static/js/jquery.corner.js"></script> 
    <script src="static/js/wow.min.js"></script>
    <script>
     new WOW().init();
    </script>
    <script src="static/js/classie.js"></script>
    <script src="static/js/uiMorphingButton_inflow.js"></script>
    <!-- Magnific Popup core JS file -->
    <script src="static/js/jquery.magnific-popup.js"></script> 
    <script type="text/javascript">
        // user input
        var t;
        function loadJSON(name, callback) {
            var xobj = new XMLHttpRequest();
            xobj.overrideMimeType("application/json");
            xobj.open('GET', name, true);
            xobj.onreadystatechange = function () {
                if (xobj.readyState == 4 && xobj.status == "200") {
                // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
                    callback(xobj.responseText);
                }
            };
            xobj.send(null);  
        }

        function initAirport(x) {
            var new_option = new Option("成田機場", 0);
            x.options.add(new_option);
            //var new_option = new Option("羽田機場", 1);
            //x.options.add(new_option);
        }
        function initTime(x) {
            for(var i=0; i<24;i++){
                var new_option = new Option(i+":00", i);
                x.options.add(new_option);
            }
        }
        /*function initDuration(x) {
            for(var i=5; i<15;i++){
                var new_option = new Option(i+"天", i);
                x.options.add(new_option);
            }
        }*/

        function initCheckbox(id, categoy) {
            var x = document.createElement("input");
            x.setAttribute("type", "checkbox");
            x.setAttribute("id", id);
            x.setAttribute("value", id);
            document.getElementById("checkboxList").appendChild(x);
            
            var label = document.createElement('label')
            label.for = id;
            label.innerHTML = categoy;
            document.getElementById("checkboxList").appendChild(label)
            
            var x = document.createElement("INPUT");
            x.setAttribute("id", "range"+id);
            x.setAttribute("type", "range");
            x.setAttribute("min", "0");
            x.setAttribute("max", "100");
            x.setAttribute("value", "0");
            document.getElementById("checkboxList").appendChild(x);

            var label = document.createElement('label')
            label.innerHTML = "<p>";
            document.getElementById("checkboxList").appendChild(label)
        }
        params = {};
        function sendForm() {
            //params["Duration"] = document.getElementById("Duration").value;
            params["startDate"] = document.getElementById("startDate").value;
            params["endDate"] = document.getElementById("endDate").value;
            params["startTime"] = document.getElementById("startTime").value;
            params["endTime"] = document.getElementById("endTime").value;
            params["startAirport"] = document.getElementById("startAirport").value;
            params["endAirport"] = document.getElementById("endAirport").value;
            params["Budget"] = document.getElementById("Budget").value;
            params["Budget"] = document.getElementById("Budget").value;
            params["like"]={};
            for (var i=0; i < Object.keys(like).length; i++) {
                if (document.getElementById(i).checked) {
                    params["like"][i] = document.getElementById("range"+i).value;
                }
                else params["like"][i] = 0;
            }
            //$("#travelForm").submit();
        }

        $("#startDate").datepicker({dateFormat:"yy-mm-dd",changeMonth: true,changeYear: true});
        $("#endDate").datepicker({dateFormat:"yy-mm-dd",changeMonth: true,changeYear: true});
        initTime(document.getElementById("startTime"))
        initTime(document.getElementById("endTime"))
        initAirport(document.getElementById("startAirport"))
        initAirport(document.getElementById("endAirport"))
        //initDuration(document.getElementById("Duration"))
        var like;
        loadJSON('static/like.json',function(response) {
            like = JSON.parse(response);
            for(var i=0; i < Object.keys(like).length; i++){
                initCheckbox(i, like[i]);
            }
        });
    </script>

    <script type="text/javascript">
        //server response
        var ans;
        var waypts = [];
        var today;
        function wayptsChange(selectTime) {
            waypts=[]
            today = ans[selectTime];
            todayObj = Object.keys(today);

            x = document.getElementById("start");
            x.options.length = 0;
            for(var n=0; n < todayObj.length; n++){
            	for(var i=0; i < todayObj.length; i++){
	            	if(today[todayObj[i]].order == n){
		            	var new_option = new Option(todayObj[i], today[todayObj[i]].coord);
		            	x.options.add(new_option);
		            }
		        }
            }
            x.selectedIndex = 0;

            x = document.getElementById("end");
            x.options.length = 0;
            for(var n=0; n < todayObj.length; n++){
            	for(var i=0; i < todayObj.length; i++){
	            	if(today[todayObj[i]].order == n){
		            	var new_option = new Option(todayObj[i], today[todayObj[i]].coord);
		            	x.options.add(new_option);
		            }
		        }
            }
            x.selectedIndex = todayObj.length-1;

            /*var tmp = 999;
            x = document.getElementById("start");
            x.options.length = 0;
            for(var i=0; i < todayObj.length; i++){
                if (tmp > today[todayObj[i]].order){
                    tmp = i;
                }
            }
            var new_option = new Option(todayObj[tmp], today[todayObj[tmp]].coord);
            x.options.add(new_option);

            var tmp = -1;
            x = document.getElementById("end");
            x.options.length = 0;
            for(var i=0; i < todayObj.length; i++){
                if (tmp < today[todayObj[i]].order){
                    tmp = i;
                }
            }
            var new_option = new Option(todayObj[tmp], today[todayObj[tmp]].coord);
            x.options.add(new_option);*/

            for(var n=0; n < todayObj.length; n++){
            	for(var i=0; i < todayObj.length; i++){
	            	if(today[todayObj[i]].order == n){
		                waypts.push({
		                    location: today[todayObj[i]].coord+"",
		                    stopover: true
		                });
		            }
		        }
		    }

        }

        function initTravelTime(x) {
            x.options.length = 0;
            for(var i=1; i <= Object.keys(ans).length; i++){
                var new_option = new Option("第"+(i)+"天", i);
                x.options.add(new_option);
            }
        }
        function travelTimeChange() {
            selectTime = document.getElementById("travelTime").value;
            wayptsChange(selectTime);
            $("table").children().remove()
            buildTable();
        }

        function buildTable() {
            var table = document.getElementById("table");
            var header = table.createTHead();
            var row = header.insertRow(0);
            var place = row.insertCell(0);
		    var popularity = row.insertCell(1);
		    var topic = row.insertCell(2);
		    var priceLevel = row.insertCell(3);
		    var weather = row.insertCell(4);
		    place.innerHTML = "地點";
		    place.setAttribute("class", "setcolor");
		    popularity.innerHTML = "人氣";
		    popularity.setAttribute("class", "setcolor");
		    topic.innerHTML = "遊記";
		    topic.setAttribute("class", "setcolor");
		    priceLevel.innerHTML = "價位";
		    priceLevel.setAttribute("class", "setcolor");
		    weather.innerHTML="weather"
		    weather.setAttribute("class", "setcolor");

		    todayObj = Object.keys(today);
            for(var n=0; n < todayObj.length; n++){
            	for(var i=0; i < todayObj.length; i++){
	            	if(today[todayObj[i]].order == n){
		            	var row = table.insertRow(-1);
		                var place = row.insertCell(0);
		                var popularity = row.insertCell(1);
		                var topic = row.insertCell(2);
		                var priceLevel = row.insertCell(3);
		                var weather = row.insertCell(4);
		                
		                place.innerHTML = todayObj[i];
		                place.setAttribute("class", "red");
		                stars = "&#9733;";
		                if(today[todayObj[i]].popularity > 15){stars +="&#9733;"}
		                if(today[todayObj[i]].popularity > 50){stars +="&#9733;"}
		                if(today[todayObj[i]].popularity > 100){stars +="&#9733;"}
		                if(today[todayObj[i]].popularity > 400){stars +="&#9733;"}
		                popularity.innerHTML = stars;
		                
		                topic.innerHTML = "";
		                for (var j=0; j < today[todayObj[i]].topic.length; j++) {
		                	if(like[today[todayObj[i]].topic[j]])
		               			topic.innerHTML += "<a href='#' target='_blank'> "+today[todayObj[i]].topic[j]+" </a>";
		                }
		                if (today[todayObj[i]].priceLevel == 0){priceLevel.innerHTML = "免費"}
		                else if(today[todayObj[i]].priceLevel == 1){priceLevel.innerHTML = "便宜"}
		                else if(today[todayObj[i]].priceLevel == 2){priceLevel.innerHTML = "適中"}
		                else if(today[todayObj[i]].priceLevel == 3){priceLevel.innerHTML = "昂貴"}
		                else if(today[todayObj[i]].priceLevel == 4){priceLevel.innerHTML = "非常昂貴"}
		                weather.innerHTML = "<img src='static/img/weather/sun.png' alt='QQ' width='20'>";
	            	}
            	}
        	}
        }
    </script>

    <script type="text/javascript">
        var test;
        function initMap() {
            // Instantiate a directions service.
            var directionsService = new google.maps.DirectionsService;
            // Create a map and center it on Manhattan.
            var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 11,
                center: {lat: 35.42, lng: 139.46}
            });
            // Create a renderer for directions and bind it to the map.
            var directionsDisplay = new google.maps.DirectionsRenderer({map: map});

            // Instantiate an info window to hold step text.
            var stepDisplay = new google.maps.InfoWindow;

            var markerArray = [];
            // Display the route between the initial start and end selections.
            calculateAndDisplayRoute(directionsDisplay, directionsService, markerArray, stepDisplay, map);
            
            // Listen to change events from the start and end lists.
            var onChangeHandler = function() {
            	waypts=[];
                calculateAndDisplayRoute(directionsDisplay, directionsService, markerArray, stepDisplay, map);
            };
            document.getElementById('submit').addEventListener('click', onChangeHandler);
            document.getElementById('travelTime').addEventListener('change', onChangeHandler);
            document.getElementById('start').addEventListener('change', onChangeHandler);
            document.getElementById('end').addEventListener('change', onChangeHandler);
        }

        function calculateAndDisplayRoute(directionsDisplay, directionsService, markerArray, stepDisplay, map) {
            // First, remove any existing markers from the map.
            for (var i = 0; i < markerArray.length; i++) {
                markerArray[i].setMap(null);
            }

            // Retrieve the start and end locations and create a DirectionsRequest using
            // WALKING directions.
            directionsService.route({
                origin: document.getElementById('start').value,
                destination: document.getElementById('end').value,
                travelMode: google.maps.TravelMode.WALKING, //DRIVING, BICYCLING, TRANSIT, WALKING
                unitSystem: google.maps.UnitSystem.METRIC, //IMPERIAL: 英里; METRIC: 公里
                waypoints: waypts,
                optimizeWaypoints: true
            }, function(response, status) {
                // Route the directions and pass the response to a function to create
                // markers for each step.
                if (status === google.maps.DirectionsStatus.OK) {
                    document.getElementById('warnings-panel').innerHTML =
                    '<b>' + response.routes[0].warnings + '</b>';
                    directionsDisplay.setDirections(response);
                    //directionsDisplay.setPanel(document.getElementById("directionsPanel"));
                    //showSteps(response, markerArray, stepDisplay, map);
                }
                else {
                    window.alert('Directions request failed due to ' + status);
                }
            });
        }

        function showSteps(directionResult, markerArray, stepDisplay, map) {
            // For each step, place a marker, and add the text to the marker's infowindow.
            // Also attach the marker to an array so we can keep track of it and remove it
            // when calculating new routes.
            var myRoute = directionResult.routes[0].legs[0];
            for (var i = 0; i < myRoute.steps.length; i++) {
                var marker = markerArray[i] = markerArray[i] || new google.maps.Marker;
                marker.setMap(map);
                marker.setPosition(myRoute.steps[i].start_location);
                attachInstructionText(stepDisplay, marker, myRoute.steps[i].instructions.replace("<b>", "").replace("</b>", "")+'"'+myRoute.steps[i].distance.text+'"', map);
            }
        }

        function attachInstructionText(stepDisplay, marker, text, map) {
            google.maps.event.addListener(marker, 'click', function() {
                // Open an info window when the marker is clicked on, containing the text
                // of the step.
                stepDisplay.setContent(text);
                stepDisplay.open(map, marker);
            });
        }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyByxCXers7DXTp81ypvcT_jqKCmch3UUJM&signed_in=true&callback=initMap">
    </script>
</body>

</html>
